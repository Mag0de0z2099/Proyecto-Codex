{% extends "base.html" %}
{% import "_forms.html" as forms %}
{% block content %}
<h1>Operadores</h1>
<form method="get" class="mb-3">
  <input name="q" value="{{ q }}" placeholder="Buscar por nombre / ID / puesto">
  <button type="submit">Buscar</button>
  {% if DEV_MODE %}
  <a href="{{ url_for('operadores.nuevo') }}">Nuevo</a>
  {% endif %}
</form>
<table>
  <thead>
    <tr>
      <th>Nombre</th><th>ID</th><th>Puesto</th><th>Status</th>
      {% if DEV_MODE %}<th></th>{% endif %}
    </tr>
  </thead>
  <tbody>
  {% for op in operadores %}
    <tr>
      <td><a href="{{ url_for('operadores.detalle', op_id=op.id) }}">{{ op.nombre }}</a></td>
      <td>{{ op.identificacion or '-' }}</td>
      <td>{{ op.puesto or '-' }}</td>
      <td>{{ op.status }}</td>
      {% if DEV_MODE %}
      <td>
        <a href="{{ url_for('operadores.editar', op_id=op.id) }}">Editar</a>
        <form action="{{ url_for('operadores.eliminar', op_id=op.id) }}" method="post" style="display:inline">
          {{ forms.csrf_field() }}
          <button type="submit" onclick="return confirm('¿Eliminar?')">Eliminar</button>
        </form>
      </td>
      {% endif %}
    </tr>
  {% else %}
    <tr><td colspan="{{ 5 if DEV_MODE else 4 }}">No hay operadores registrados.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% if pagination.pages > 1 %}
<nav class="pagination">
  {% if pagination.has_prev %}
  <a href="{{ url_for('operadores.index', page=pagination.prev_num, q=q, per_page=pagination.per_page) }}">« Anterior</a>
  {% endif %}
  <span>Página {{ pagination.page }} de {{ pagination.pages }}</span>
  {% if pagination.has_next %}
  <a href="{{ url_for('operadores.index', page=pagination.next_num, q=q, per_page=pagination.per_page) }}">Siguiente »</a>
  {% endif %}
</nav>
{% endif %}
{% endblock %}
