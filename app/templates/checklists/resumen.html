{% extends "base.html" %}
{% block content %}
<h1>Resumen de checklists</h1>
<form method="get" class="mb-3" action="{{ url_for('checklists_bp.resumen') }}">
  <label>Desde</label><input type="date" name="desde" value="{{ (desde or '') }}">
  <label>Hasta</label><input type="date" name="hasta" value="{{ (hasta or '') }}">
  <button type="submit">Filtrar</button>
  <a href="{{ url_for('checklists_bp.resumen_pdf', desde=desde, hasta=hasta) }}">PDF</a>
</form>
<div class="cards">
  <div class="card">Ejecuciones: <strong>{{ total }}</strong></div>
  <div class="card">Promedio cumplimiento: <strong>{{ '%.1f'|format(avg_ok) }}%</strong></div>
</div>
<h3 class="mt-3">Ãšltimos</h3>
<table class="table">
  <thead><tr><th>Fecha</th><th>Plantilla</th><th>Norma</th><th>% OK</th></tr></thead>
  <tbody>
    {% for r in ultimos %}
      <tr><td>{{ r.fecha }}</td><td>{{ r.template.nombre }}</td><td>{{ r.template.norma }}</td><td>{{ '%.1f'|format(r.pct_ok) }}%</td></tr>
    {% endfor %}
  </tbody>
</table>
<style>.cards{display:flex;gap:12px}.card{padding:10px 14px;border:1px solid #333;border-radius:8px}</style>
{% endblock %}
