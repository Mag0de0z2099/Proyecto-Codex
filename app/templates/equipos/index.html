{% extends "layout.html" %}
{% block content %}
<h1 class="mb-3">Equipos</h1>

<form method="get" class="mb-3" action="{{ url_for('equipos.index') }}">
  <input type="text" name="q" value="{{ q }}" placeholder="Buscar por nombre, descripción o serie">
  <button type="submit">Buscar</button>
  {% if DEV_MODE %}
    <a href="{{ url_for('equipos.create') }}">+ Nuevo</a>
  {% endif %}
</form>

<table class="table">
  <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Serie</th>
      <th>Estatus</th>
      <th>Descripción</th>
      {% if DEV_MODE %}<th>Acciones</th>{% endif %}
    </tr>
  </thead>
  <tbody>
    {% for r in rows %}
    <tr>
      <td>{{ r.id }}</td>
      <td>{{ getattr(r, 'nombre', '') }}</td>
      <td>{{ getattr(r, 'serie', '') }}</td>
      <td>{{ getattr(r, 'estatus', '') }}</td>
      <td>{{ getattr(r, 'descripcion', '') }}</td>
      {% if DEV_MODE %}
      <td>
        <a href="{{ url_for('equipos.edit', id=r.id) }}">Editar</a>
        <form method="post" action="{{ url_for('equipos.delete', id=r.id) }}" style="display:inline" onsubmit="return confirm('¿Eliminar?');">
          <button type="submit">Eliminar</button>
        </form>
      </td>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>

{% if pagination.pages > 1 %}
<nav>
  {% if pagination.has_prev %}
    <a href="{{ url_for('equipos.index', page=pagination.prev_num, q=q) }}">&laquo; Anterior</a>
  {% endif %}
  <span>Página {{ pagination.page }} de {{ pagination.pages }}</span>
  {% if pagination.has_next %}
    <a href="{{ url_for('equipos.index', page=pagination.next_num, q=q) }}">Siguiente &raquo;</a>
  {% endif %}
</nav>
{% endif %}

{% endblock %}
