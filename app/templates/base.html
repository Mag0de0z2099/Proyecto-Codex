<!doctype html>
<html lang="es">
{% import "_icons.html" as i %}
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}SGC — Obra de Dragado{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">
</head>
<body>
  <header class="navbar">
    <div class="nav-left">
      <span class="brand">
        <img class="logo" src="{{ url_for('static', filename='img/siglo21.png') }}" alt="Siglo 21">
        <span>SGC-Obra</span>
      </span>
    </div>
    <nav class="nav-right">
      {% if current_user.is_authenticated %}
        <a href="{{ url_for('equipos.index') }}">Equipos</a>
        <a href="{{ url_for('partes.index') }}">Partes</a>
        <a href="{{ url_for('checklists.index') }}">Checklists</a>
        <a href="{{ url_for('operadores.index') }}">Operadores</a>
        <form method="post" action="{{ url_for('auth.logout') }}" class="inline">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <button class="btn" type="submit">Logout</button>
        </form>
      {% else %}
        <a href="{{ url_for('public.home') }}">Inicio</a>
        <a href="{{ url_for('auth.login') }}" class="btn">Login</a>
      {% endif %}
    </nav>
  </header>

  <main class="container">
    {% if current_user.is_authenticated %}
      <nav>
        <a href="{{ url_for('dashboard.home') }}">Inicio</a> |
        <a href="{{ url_for('equipos.index') }}">Equipos</a> |
        <a href="{{ url_for('operadores.index') }}">Operadores</a> |
        <a href="{{ url_for('checklists.index') }}">Checklists</a> |
        <a href="{{ url_for('partes.index') }}">Partes</a>
      </nav>
      <hr>
    {% endif %}
    {% if current_user.is_authenticated and (current_user.is_approved is defined) and not current_user.is_approved %}
      <div class="alert alert-warning" role="status">
        Tu cuenta aún no ha sido aprobada. Algunas secciones pueden estar bloqueadas.
      </div>
    {% endif %}
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-stack">
          {% for category, message in messages %}
            <div class="flash {{ category }}">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  <footer class="footer">
    <small>© 2025 SGC — Control de Calidad y Seguridad en Obra de Dragado</small>
  </footer>
</body>
</html>
