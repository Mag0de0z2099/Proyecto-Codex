{% extends "base.html" %}
{% block title %}Crear cuenta{% endblock %}
{% block content %}
<section class="auth-wrap">
  <h1>Crear cuenta</h1>
  {% if invite %}
    <p class="text-muted">Registro mediante invitación activa.</p>
  {% elif config.SIGNUP_MODE != 'open' %}
    <p class="text-muted">Se requiere una invitación para registrarse.</p>
  {% endif %}
  <form method="post" action="{{ url_for('auth.register_post', token=request.args.get('token')) }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <input type="hidden" name="token" value="{{ request.args.get('token', '') }}">
    <label class="form-label">
      Usuario
      <input class="form-control" type="text" name="username" required autofocus>
    </label>
    <label class="form-label">
      Correo electrónico
      <input class="form-control" type="email" name="email" value="{{ invite.email if invite else '' }}" {{ 'readonly' if invite and invite.email }} required>
    </label>
    <label class="form-label">
      Contraseña
      <input class="form-control" type="password" name="password" required>
    </label>
    <label class="form-label">
      Confirmar contraseña
      <input class="form-control" type="password" name="confirm" required>
    </label>
    {% if config.HCAPTCHA_SITE_KEY %}
      <div class="h-captcha" data-sitekey="{{ config.HCAPTCHA_SITE_KEY }}"></div>
    {% endif %}
    <button type="submit">Crear cuenta</button>
    <div class="mt-4 text-center">
      <a href="{{ url_for('auth.login') }}" class="btn btn-lg btn-outline-primary">
        ↩️ Volver al login
      </a>
    </div>
  </form>
</section>
{% if config.HCAPTCHA_SITE_KEY %}
<script src="https://js.hcaptcha.com/1/api.js" async defer></script>
{% endif %}
{% endblock %}
