{% extends "admin/_base_admin.html" %}
{% block admin_title %}Dashboard · Admin · SGC{% endblock %}
{% block admin_content %}
<h1>Dashboard SGC</h1>
<div class="row g-3" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem">
  <div class="card"><div class="card-body">
    <div class="fw-bold text-muted">Proyectos</div>
    <div class="fs-3">{{ total_projects }}</div>
  </div></div>
  <div class="card"><div class="card-body">
    <div class="fw-bold text-muted">Avance promedio</div>
    <div class="fs-3">{{ avg_progress }}%</div>
  </div></div>
  <div class="card"><div class="card-body">
    <div class="fw-bold text-muted">Presupuesto</div>
    <div class="fs-5">${{ "{:,.0f}".format(budget) }}</div>
  </div></div>
  <div class="card"><div class="card-body">
    <div class="fw-bold text-muted">Gastado</div>
    <div class="fs-5">${{ "{:,.0f}".format(spent) }}</div>
  </div></div>
</div>

<h3 class="mt-4">Últimas bitácoras</h3>
<table class="table">
  <thead><tr><th>Fecha</th><th>Proyecto</th><th>Autor</th><th>Texto</th></tr></thead>
  <tbody>
    {% for b in ultimas %}
    <tr>
      <td>{{ b.date }}</td>
      <td>{{ b.project.name }}</td>
      <td>{{ b.author or "-" }}</td>
      <td>{{ b.text[:120] }}{% if b.text|length>120 %}…{% endif %}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
